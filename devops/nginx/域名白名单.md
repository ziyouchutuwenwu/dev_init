# 域名白名单

## 例子

```nginx
# 80 端口，合法域名走 https
server {
    listen 80;
    # 多域名 server_name aaa.com bbb.com;
    server_name $DOMAIN_NAME;
    return 301 https://$host$request_uri;
}

# 80 端口，非法域名直接断开
server {
    listen 80 default_server;
    server_name _;
    return 444;
}

# 443 端口，非法域名直接断开
server{
  listen 443 default_server;
  server_name _;
  ssl_certificate     /usr/local/nginx/cert/$CRT_FILE;
  ssl_certificate_key /usr/local/nginx/cert/$KEY_FILE;
  access_log off;
  return 444;
}

# 443 端口，合法域名的业务
server {
    listen 443 ssl;

    server_name  $DOMAIN_NAME;

    ssl_certificate     /usr/local/nginx/cert/$CRT_FILE;
    ssl_certificate_key /usr/local/nginx/cert/$KEY_FILE;

    include /etc/nginx/conf.d/office.conf;
    include /etc/nginx/conf.d/business.conf;

    # 二次防护：确保 Host header 是合法域名
    if ($host != "$DOMAIN_NAME") {
        return 444;
    }
}
```
