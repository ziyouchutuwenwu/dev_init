# 翻墙

## 分类

### 本机代理

```sh
#! /usr/bin/env /bin/bash

CURRENT_DIR=$(cd "$(dirname "$0")";pwd)

VPS=xx.xx.xx.xx

autossh -M 0 -i $CURRENT_DIR/keys/key \
  -o "StrictHostKeyChecking no" \
  -o "ServerAliveInterval 30" \
  -CfND 0.0.0.0:1080 \
  root@$VPS
```

### 跳板机

支持无限层级

```sh
#!/usr/bin/env bash

set -euo pipefail

CURRENT_DIR=$(cd "$(dirname "$0")"; pwd)

VPS=xx.xx.xx.xx
JUMP1=yy.yy.yy.yy
JUMP2=zz.zz.zz.zz

# autossh 和 ssh-agent 绑定
(
  set -euo pipefail

  eval "$(ssh-agent -s)"
  trap 'ssh-agent -k' EXIT

  ssh-add "$CURRENT_DIR/keys/key"

  # 不能用 -f 参数
  autossh -M 0 \
    -o "StrictHostKeyChecking no" \
    -o "ServerAliveInterval 30" \
    -CND 0.0.0.0:1080 \
    -J root@$JUMP1,root@$JUMP2 \
    root@$VPS
) > /dev/null 2>&1 &
```
