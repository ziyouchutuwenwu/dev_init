# 认证方式

## 说明

| 类型  | 数据库      | 用户     | IP               | 认证方式      | 解释                                                                       |
| ----- | ----------- | -------- | ---------------- | ------------- | -------------------------------------------------------------------------- |
| host  | replication | replica  | 192.168.xx.xx/32 | trust         | 某个内网 ip 的 replica 用户，有 replication 权限，完全信任，不需要密码验证 |
| local | all         | postgres | —                | peer          | peer 用系统用户名登陆，无需密码；系统用户名必须与数据库用户名一致。        |
| host  | all         | all      | 127.0.0.1/32     | scram-sha-256 | SCRAM-SHA-256 比 md5 更安全                                                |
| host  | all         | all      | ::1/128          | scram-sha-256 | ipv6                                                                       |
| local | replication | all      | —                | peer          | 有 replication 权限的用户，本地无密码登陆                                  |
| host  | replication | all      | 127.0.0.1/32     | scram-sha-256 | 有 replication 权限的用户，配置 ipv4                                       |
| host  | replication | all      | ::1/128          | scram-sha-256 | 有 replication 权限的用户，配置 ipv6                                       |
| host  | all         | all      | 0.0.0.0/0        | scram-sha-256 | 自己加的                                                                   |

## 配置

```sh
cd /etc/postgresql/版本号/main
```

pg_hba.conf

```conf
# postgres 之外的账户，都用密码登陆
# local all all 用密码登陆
local   all             all                                     scram-sha-256

# 所有的都用密码验证
host    all             all             0.0.0.0/0               scram-sha-256
```
