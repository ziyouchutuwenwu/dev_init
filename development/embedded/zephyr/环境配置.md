# 环境配置

## 说明

目录结构

```sh
zephyr
├── sdk
├── repo
└── venv
```

## 步骤

### 准备

```sh
cmake ninja
```

### venv

```sh
uv venv ./venv
source venv/bin/activate
uv pip install west

uv run west packages pip --install
```

### 配置

源码包

```sh
cd repo

west init
west update --fetch-opt="--depth=1" -f always

# 更换目录以后，也要手动运行
west zephyr-export
```

sdk

```sh
# west sdk install --install-dir ～/dev/zephyr/sdk/
axel https://github.com/zephyrproject-rtos/sdk-ng/releases/download/v0.17.4/zephyr-sdk-0.17.4_linux-x86_64.tar.xz
```

解压

```bash
cd sdk
./setup.sh -t all
```

env.sh

```sh
#!/usr/bin/env bash

ZEPHYR_ROOT="$HOME/dev/zephyr"
WORKSPACE="$ZEPHYR_ROOT/repo"

ORIGINAL_DIR="$(pwd)"

cd "$WORKSPACE" || return

source "$ZEPHYR_ROOT/venv/bin/activate"
source zephyr/zephyr-env.sh

export ZEPHYR_TOOLCHAIN_VARIANT=zephyr
export ZEPHYR_SDK_INSTALL_DIR="$ZEPHYR_ROOT/sdk"

cd "$ORIGINAL_DIR"
```

### 测试

repo/zephyr/samples 里面找一个复制出来

```bash
source ~/dev/zephyr/env.sh

west build -b qemu_x86
west build -t run
```
