# 配置

## 说明

Kconfig 里面定义的宏，prj 或者代码里引用的时候，要加前缀 `CONFIG_`

### Kconfig

定义宏
手动 source 其它文件

### proj

给宏赋值

按顺序加载，相同配置，后者覆盖前者

```sh
socs/xxx.conf
boards/xxx.conf
prj.conf
```

## 例子

Kconfig

```conf
source "Kconfig.zephyr"

source "$(APP_DIR)/configs/Kconfig_demo1"
source "$(APP_DIR)/configs/Kconfig_demo2"
```

Kconfig_demo1

```conf
menu "demo menu"

config DEMO1
    bool "demo1 config"
    default n

endmenu
```

Kconfig_demo2

```conf
config DEMO2
    string "demo2 config"
    default "config in Kconfig_demo2"
```

boards/esp32s3_devkitc_procpu.conf

```conf
CONFIG_DEMO1=y
```

socs/esp32s3_procpu.conf

```conf
CONFIG_DEMO2="value in socs config"
```

main.c

```c
#include <stdio.h>

int main(void)
{
  printf("编译目标: %s\n", CONFIG_BOARD_TARGET);

#ifdef CONFIG_DEMO1
  printf("boards/esp32s3_devkitc.conf 加载成功\n");
  printf("CONFIG_DEMO1 = %d\n", CONFIG_DEMO1);
#else
  printf("board config 未加载\n");
#endif

#ifdef CONFIG_DEMO2
  printf("socs/esp32s3_procpu.conf 加载成功\n");
  printf("CONFIG_DEMO2 = %s\n", CONFIG_DEMO2);
#else
  printf("soc config 未加载\n");
#endif
  return 0;
}
```

编译

```sh
# 板是 esp32s3_devkitc
# soc 是 esp32s3_procpu
west build -b esp32s3_devkitc/esp32s3/procpu
```
