# 调用库

## 分类

### 调用动态库

main.zig

```zig
const std = @import("std");
const c = @cImport({
    @cInclude("dlfcn.h");
});

const ADD = *const fn (i32, i32) callconv(.c) i32;

pub fn main() !void {
    const lib = c.dlopen("./libzig_demo.so", c.RTLD_LAZY) orelse {
        std.debug.print("Failed to load library: {s}\n", .{c.dlerror()});
        return error.LoadLibraryFailed;
    };
    defer _ = c.dlclose(lib);

    const add_proc = c.dlsym(lib, "add") orelse {
        std.debug.print("Failed to find symbol: {s}\n", .{c.dlerror()});
        return error.SymbolNotFound;
    };

    const add: ADD = @ptrCast(add_proc);
    const result = add(2, 3);
    std.debug.print("Result: {}\n", .{result});
}
```

build.zig

```zig
exe.linkSystemLibrary("c");
```

### 调用静态库

main.zig

```zig
const std = @import("std");

extern fn add(a: i32, b: i32) callconv(.c) i32;

pub fn main() !void {
    const result = add(2, 3);
    std.debug.print("Result: {}\n", .{result});
}
```

build.zig

```zig
exe.addObjectFile(b.path("../lib/zig-out/lib/libzig_demo.a"));
```
