# 测试

## 准备

目录结构

```sh
├── src
├── test
│   ├── aa_test.zig
│   ├── bb_test.zig
│   ├── mod.zig
│   └── sub_test
│       └── cc_test.zig
```

## 例子

### 单独跑

```sh
zig test test/aa_test.zig
```

### 批量跑

test/mod.zig

```zig
pub const aa_test = @import("aa_test.zig");
pub const bb_test = @import("bb_test.zig");
pub const cc_test = @import("sub_test/cc_test.zig");

// 确保测试文件被实际引用
comptime {
    _ = aa_test;
    _ = bb_test;
    _ = cc_test;
}
```

### build.zig

添加

```zig
// 测试模块
const test_mod = b.createModule(.{
    .root_source_file = b.path("test/mod.zig"),
    .target = target,
    .optimize = optimize,
});
// 测试
const tests = b.addTest(.{
    .root_module = test_mod,
});
const run_tests = b.addRunArtifact(tests);

......

// 增加到测试流程
test_step.dependOn(&run_tests.step);
```

运行，所有的 test 都会被执行

```sh
zig build test
```
