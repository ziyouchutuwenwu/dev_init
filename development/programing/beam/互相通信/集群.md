# 集群

## 注意

erlang 的里面是一个短横，如果写了俩，不会报错，会忽略你设置的 cookie, 重新生成 `~/.erlang.cookie`, 导致无法连接

## 节点

### longname

```sh
erl -name aaa@127.0.0.1 -setcookie 111
iex --name bbb@127.0.0.1 --cookie 111
```

```elixir
Node.connect :"aaa@127.0.0.1"
Node.list
```

```erlang
net_kernel:connect_node('bbb@127.0.0.1').
nodes().
```

### shortname

```sh
erl -sname aaa -setcookie 111
iex --sname bbb --cookie 111
```

```elixir
Node.connect :aaa@manjaro
Node.list
```

```erlang
net_kernel:connect_node('bbb@manjaro').
nodes().
```

## cookie

### 启动设置

```sh
erl -sname aaa -setcookie 111
iex --sname bbb --cookie 111
```

phoenix 项目

```sh
elixir --sname bbb --cookie 111 -S mix phx.server -e 'Demo.hello'
iex --sname bbb --cookie 111 -S mix phx.server
```

### 读取文件

创建文件 `~/.erlang.cookie`, 随便写一串数字, shell 会直接读取这个 cookie 文件

```sh
erl -sname aaa
iex --sname bbb
```

### 测试

```erlang
% erlang
erlang:get_cookie().
erlang:set_cookie(node(), '222').
```

```elixir
# elixir
:erlang.get_cookie()
:erlang.set_cookie(node(), :"222")
```
